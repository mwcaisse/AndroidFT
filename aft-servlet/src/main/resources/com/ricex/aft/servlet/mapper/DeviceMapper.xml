<?xml version="1.0" encoding="UTF-8" ?>	 
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.ricex.aft.servlet.mapper.DeviceMapper">

	<cache/>

	<!-- Device result map -->
	<resultMap id="deviceResultMap" type="Device">
		<id property="deviceId" column="DEV_ID" />
		<result property="deviceUid" column="DEV_UID" />
		<result property="deviceName" column="DEV_NAME"/>
		<result property="deviceRegistrationId" column="DEV_REG_ID" />
	</resultMap>

	
	<!-- select a single device -->
	<select id="getDeviceId" resultMap="deviceResultMap">
		SELECT * FROM DEVICE WHERE DEV_ID = #{deviceId}
	</select>

	<!--  selects all devices -->
	<select id="getAllDevices" resultMap="deviceResultMap">
		SELECT * FROM DEVICE	
	</select>
	
	<select id="getDeviceUid" parameterType="String" resultMap="deviceResultMap">
		SELECT * FROM DEVICE WHERE DEV_UID = #{deviceUid}
	</select>
	
	<!-- Gets the device upload key for the specified device -->
	<select id="getDeviceKey" parameterType="Long" resultType="String">
	    SELECT DEV_UPLOAD_KEY FROM DEVICE
	    WHERE DEV_ID = #{deviceId}
	</select>
	
	<!-- Updates the device in the param -->
	<update id="updateDevice">
		UPDATE DEVICE SET
			DEV_NAME = #{deviceName},
			DEV_UID = #{deviceUid},
			DEV_REG_ID = #{deviceRegistrationId},
			DEV_UPLOAD_KEY = #{deviceKey}
		WHERE DEV_ID = #{deviceId}
	</update>
	
	<!-- Inserts the device in the param -->
	<insert id="createDevice" useGeneratedKeys="true" keyProperty="deviceId">
		INSERT INTO DEVICE (DEV_UID, DEV_NAME, DEV_REG_ID, DEV_UPLOAD_KEY)
		VALUES (#{deviceUid}, #{deviceName}, #{deviceRegistrationId}, #{deviceUploadKey})
	</insert>
	
</mapper>